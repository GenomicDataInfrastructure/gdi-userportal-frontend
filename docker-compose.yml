# SPDX-FileCopyrightText: 2024 PNED G.I.E.
#
# SPDX-License-Identifier: Apache-2.0
version: "3"

services:
  frontend:
    build:
      context: .
    restart: unless-stopped
    environment:
      - CKAN_URL=https://ckan-test.healthdata.nl
      - NEXTAUTH_URL=http://localhost:3000
      - NEXTAUTH_SECRET=VvBIryJIFxQFbhG45BDKEB4AQagzy27y873YM6B2Vcs=
      - KEYCLOAK_CLIENT_ID=ckan
      - KEYCLOAK_ISSUER_URL=https://keycloak-test.healthdata.nl/realms/ckan
      - END_SESSION_URL=https://keycloak-test.healthdata.nl/realms/ckan/protocol/openid-connect/logout
      - REFRESH_TOKEN_URL=https://keycloak-test.healthdata.nl/realms/ckan/protocol/openid-connect/token
    healthcheck:
      test:
        [
          "CMD",
          "wget",
          "-qO",
          "-",
          "http://localhost:3000/api/health",
          "||",
          "exit",
          "1",
        ]
    ports:
      - "80:3000"
